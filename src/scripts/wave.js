/*  
MIT License

Copyright (c) 2020 Austin Michaud

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
var Wave=function(){"use strict";var t={fromStream:function(t,e,r={}){let o,i,a;this.current_stream.id=e,this.current_stream.options=r,this.sources[t.toString()]?(cancelAnimationFrame(this.sources[t.toString()].animation),o=this.sources[t.toString()].audioCtx,i=this.sources[t.toString()].analyser,a=this.sources[t.toString()].source):(o=new AudioContext,i=o.createAnalyser(),(a=o.createMediaStreamSource(t)).connect(i),a.connect(o.destination),this.sources[t.toString()]={audioCtx:o,analyser:i,source:a}),i.fftsize=32768;let n=i.frequencyBinCount;this.current_stream.data=new Uint8Array(n);let s=this;function l(){s.current_stream.animation=requestAnimationFrame(s.current_stream.loop),s.sources[t.toString()].animation=s.current_stream.animation,i.getByteFrequencyData(s.current_stream.data),s.visualize(s.current_stream.data,s.current_stream.id,s.current_stream.options)}this.current_stream.loop=l,l()},stopStream:function(){cancelAnimationFrame(this.current_stream.animation)},playStream:function(){this.current_stream.loop()}},e=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r;const l=new n(o);e=l.mutateData(e,"split",4)[0],e=l.mutateData(e,"scale",i);let c=l.getPoints("line",a,[0,i],e.length,e,{offset:100});c.start=c.start.slice(0,c.end.length-1),c.start.push([a,i]),c.start.push([0,i]),l.drawPolygon(c.start,{lineColor:s[0],color:s[1],radius:.008*i})},r=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=a/2,s=i/2,l=i/4,c=(i/2-l)/255,h=.703125*Math.PI/180;for(let t=1;t<=512;t++){let r=e[600%t];r*=c;let i=++t*h,a=n+l*Math.cos(i),p=s+l*Math.sin(i);o.moveTo(a,p);let d=n+(l+r)*Math.cos(i),u=s+(l+r)*Math.sin(i);o.lineTo(d,u)}o.stroke(),r.colors[1]&&(o.arc(n,s,.9*l,0,2*Math.PI),o.fillStyle=r.colors[1],o.fill())},o=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=a/2,s=i/2,l=(i-10)/2,c=(l-l/5)/255,h=2.4*Math.PI/180;o.arc(n,s,l,0,2*Math.PI,!0);let p=n+(l-e[0]*c)*Math.cos(0),d=s+(l-e[0]*c)*Math.sin(0);o.moveTo(p,d);let u=0;for(let t=0;t<150;t++){u+=1,t>=75&&(u-=2);let r=e[u],i=t*h,a=n+(l-(r*=c))*Math.cos(i),p=s+(l-r)*Math.sin(i);o.lineTo(a,p),o.arc(a,p,2,0,2*Math.PI)}o.lineTo(p,d),o.stroke(),o.fillStyle=r.colors[1]||"#fff0",o.fill()},i=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=i/255,s=a/64,l=Math.floor(64/r.colors.length);for(let t=1;t<=64;t++){let a=e[t];a*=n;let c=s*t;if(o.moveTo(c,i),o.lineTo(c,i-a),t%l==0){let e=t/l-1;o.strokeStyle=r.colors[e],o.stroke(),o.beginPath()}}},a=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=i/255,s=a/128,l=Math.floor(128/r.colors.length);for(let t=1;t<=128;t++){let a=e[t];a+=5;let c=s*t,h=i/2+(a*=n)/2;if(o.moveTo(c,h),o.lineTo(c,h-a),t%l==0){let e=t/l-1;o.strokeStyle=r.colors[e],o.stroke(),o.beginPath()}}},n=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r;const l=new n(o);e=l.mutateData(e,"organize").mids,e=l.mutateData(e,"split",2)[0],e=l.mutateData(e,"shrink",100),e=l.mutateData(e,"mirror"),e=l.mutateData(e,"scale",i),e=l.mutateData(e,"amp",.75);let c=l.getPoints("line",a,[0,i/2],e.length,e,{offset:50});c.start.forEach((t,e)=>{l.drawLine(t,c.end[e],{lineColor:s[0]}),l.drawCircle(t,.01*i,{color:s[1]||s[0]}),l.drawCircle(c.end[e],.01*i,{color:s[1]||s[0]})})},s=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=i/4,s=n/2,l=a/2,c=i/2,h=(n-s)/2**24.6,p=2.8125*Math.PI/180,d=Math.floor(128/r.colors.length);for(let t=1;t<=128;t++){let i=(e[t]+100)**3*h,a=t*p,u=l+(n-(i+s))*Math.cos(a),f=c+(n-(i+s))*Math.sin(a);o.moveTo(u,f);let g=l+(n+i)*Math.cos(a),x=c+(n+i)*Math.sin(a);if(o.lineTo(g,x),t%d==0){let e=t/d-1;o.strokeStyle=r.colors[e],o.stroke(),o.beginPath()}}o.stroke()},l=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=i/4,s=a/2,l=i/2,c=n/255,h=360/56*Math.PI/180;for(let t=1;t<=56;t++){let r=e[t]*c,i=t*h,a=s+(n-r/2)*Math.cos(i),p=l+(n-r/2)*Math.sin(i);o.moveTo(a,p);let d=s+(n+r)*Math.cos(i),u=l+(n+r)*Math.sin(i);o.lineTo(d,u);let f=s+(n+r)*Math.cos(i+h),g=l+(n+r)*Math.sin(i+h);o.lineTo(f,g);let x=s+(n-r/2)*Math.cos(i+h),y=l+(n-r/2)*Math.sin(i+h);o.lineTo(x,y),o.lineTo(a,p)}r.colors[1]&&(o.fillStyle=r.colors[1],o.fill()),o.stroke()},c=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=i/255,s=a/64;for(let t=0;t<64;t++){let r=e[t];r*=n;let a=s*t;o.rect(a,i,s,-r)}o.fillStyle=r.colors[1]||r.colors[0],o.stroke(),o.fill()},h=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=i/255,s=a/50;for(let t=0;t<=50;t++){let r=e[t];r*=n;let a=s*t;o.rect(a,i/2+r/2,s,-r)}r.colors[1]&&(o.fillStyle=r.colors[1],o.fill()),o.stroke()},p=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=i/4,s=n/4,l=a/2,c=i/2,h=(n-s-35)/255,p=3*Math.PI/180,d=[],u=[];for(let t=1;t<=120;t++){let r=e[200%t]*h,i=t*p,a=l+(n-r+s)*Math.cos(i),f=c+(n-r+s)*Math.sin(i);o.moveTo(a,f),u.push({x:a,y:f});let g=l+(n+r+s)*Math.cos(i),x=c+(n+r+s)*Math.sin(i);o.lineTo(g,x),d.push({x:g,y:x})}o.moveTo(d[0].x,d[0].y);for(let t in d)t=d[t],o.lineTo(t.x,t.y);o.closePath(),o.moveTo(u[0].x,u[0].y);for(let t=u.length-1;t>=0;t++)t=u[t],o.lineTo(t.x,t.y);o.closePath(),r.colors[1]&&(o.fillStyle=r.colors[1],o.fill()),o.stroke(),o.beginPath(),o.moveTo(u[0].x,u[0].y);for(let t in u)t=u[t],o.lineTo(t.x,t.y);o.closePath(),r.colors[2]&&(o.fillStyle=r.colors[2],o.fill()),o.stroke()},d=t=>{let{data:e,options:r,ctx:o,h:i,w:a}=t,n=i/4,s=a/2,l=i/2,c=n/255,h=3.6*Math.PI/180,p=s+(n+0)*Math.cos(0),d=l+(n+0)*Math.sin(0);o.moveTo(p,d);for(let t=1;t<=100;t++){let r=e[350%t]*c,i=t*h,a=s+(n+r)*Math.cos(i),p=l+(n+r)*Math.sin(i);o.lineTo(a,p)}o.closePath(),o.stroke(),r.colors[1]&&(o.fillStyle=r.colors[1],o.fill())},u=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r,l=new n(o),c=i<a?i:a;(e=[(e=l.mutateData(e,"organize")).mids,e.vocals])[0]=l.mutateData(e[0],"scale",c/4),e[1]=l.mutateData(e[1],"scale",c/8),e[0]=l.mutateData(e[0],"shrink",.2),e[0]=l.mutateData(e[0],"split",2)[0],e[0]=l.mutateData(e[0],"reverb"),e[1]=l.mutateData(e[1],"reverb");let h=l.getPoints("circle",c/2,[a/2,i/2],e[0].length,e[0]),p=l.getPoints("circle",c/4,[a/2,i/2],e[1].length,e[1]);l.drawPolygon(h.end,{close:!0,radius:4,lineColor:s[0],color:s[1]}),l.drawPolygon(p.end,{close:!0,radius:4,lineColor:s[2],color:s[3]});let d=(c/4+c/2)/2,u=e[1]=l.mutateData(e[1],"scale",c/4-c/2),f=l.getPoints("circle",d,[a/2,i/2],e[1].length,u);f.start.forEach((t,e)=>{l.drawLine(t,f.end[e],{lineColor:s[4]||s[2]})})},f=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r,l=new n(o),c=i<a?i:a;(e=l.mutateData(e,"organize")).vocals=l.mutateData(e.vocals,"scale",c/2/2),e.base=l.mutateData(e.base,"scale",c/2/2);let h=l.getPoints("circle",c/2,[a/2,i/2],e.vocals.length,e.vocals),p=l.getPoints("circle",c/2,[a/2,i/2],e.vocals.length,e.vocals,{offset:100}),d=l.getPoints("circle",c/2,[a/2,i/2],e.base.length,e.base,{offset:100});h.start.forEach((t,e)=>{l.drawLine(t,h.end[e],{lineColor:s[0]})}),l.drawPolygon(p.start,{close:!0,lineColor:s[1],color:s[3],radius:5}),l.drawPolygon(d.start,{close:!0,lineColor:s[2],color:s[4],radius:5})},g=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r,l=new n(o);e=l.mutateData(e,"organize").base,e=l.mutateData(e,"shrink",20).slice(0,19),e=l.mutateData(e,"scale",i);let c=l.getPoints("line",a,[0,i],e.length,e),h=a/20-5,p=0;c.start.forEach((t,r)=>{let o=Math.ceil(e[r]/h),a=(i-i/h*5)/h,n=Math.ceil(a/s.length);for(let e=1;e<=o;e++){let r=[t[0],t[1]-h*e-5*e];l.drawSquare(r,h,{color:s[p],lineColor:"black"}),e%n==0&&++p>=s.length&&(p=s.length-1)}p=0})},x=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r;const l=new n(o);e=l.mutateData(e,"organize").vocals,e=l.mutateData(e,"shrink",10),e=l.mutateData(e,"scale",i),e=l.mutateData(e,"amp",1);let c=l.getPoints("line",a,[0,i/2],e.length,e,{offset:50}),h=0,p=Math.ceil(e.length/s.length);c.start.forEach((t,r)=>{(r+1)%p==0&&h++,l.drawRectangle(t,e[r],a/e.length,{color:s[h]})})},y=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r,l=new n(o);e=l.mutateData(e,"shrink",300),e=l.mutateData(e,"scale",i/2),e=l.mutateData(e,"split",4).slice(0,3);let c=0;e.forEach(t=>{let e=l.getPoints("line",a,[0,i/2],t.length,t);l.drawPolygon(e.end,{lineColor:s[c],radius:.015*i});let r=l.getPoints("line",a,[0,i/2],t.length,t,{offset:100});l.drawPolygon(r.start,{lineColor:s[c],radius:.015*i}),c++})},m=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r;const l=new n(o);e=l.mutateData(e,"shrink",200).slice(0,120),e=l.mutateData(e,"mirror"),e=l.mutateData(e,"scale",i/4+i/4*.35);let c=l.getPoints("circle",i/2,[a/2,i/2],e.length,e,{offset:35,rotate:270});c.start.forEach((t,e)=>{l.drawLine(t,c.end[e])}),l.drawPolygon(c.start,{close:!0}),c.end.forEach((t,e)=>{l.drawCircle(t,.01*i,{color:s[0]})})},w=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,s=new n(o);e=s.mutateData(e,"shrink",1/8),e=s.mutateData(e,"split",2)[0],e=s.mutateData(e,"scale",i);let l=s.getPoints("line",a,[0,i/2],e.length,e,{offset:50}),c=null;l.start.forEach((t,e)=>{c&&s.drawLine(c,t),s.drawLine(t,l.end[e]),c=l.end[e]})},v=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,{colors:s}=r;const l=new n(o);let c=i<a?i:a;e=l.mutateData(e,"shrink",100),e=l.mutateData(e,"split",2)[0];let h=e=l.mutateData(e,"scale",i/4),p=l.getPoints("circle",c/2,[a/2,i/2],e.length,e);l.drawPolygon(p.end,{close:!0}),p.start.forEach((t,e)=>{l.drawLine(t,p.end[e])}),e=l.mutateData(e,"scale",.7),p=l.getPoints("circle",c/2,[a/2,i/2],e.length,e),l.drawPolygon(p.end,{close:!0}),e=l.mutateData(e,"scale",.3),p=l.getPoints("circle",c/2,[a/2,i/2],e.length,e),l.drawPolygon(p.end,{close:!0}),l.drawCircle([a/2,i/2],c/2,{color:s[2]}),h=l.mutateData(h,"scale",1.4),(p=l.getPoints("circle",c/2,[a/2,i/2],h.length,h)).end.forEach((t,e)=>{l.drawCircle(t,.01*c,{color:s[1],lineColor:s[1]||s[0]})})},b=t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n}=t,s=new n(o),l=i<a?i:a;e=s.mutateData(e,"shrink",200),e=s.mutateData(e,"split",2)[0],e=s.mutateData(e,"scale",i/2);let c=s.getPoints("circle",l/2,[a/2,i/2],e.length,e,{offset:50});s.drawPolygon(c.end,{close:!0}),s.drawPolygon(c.start,{close:!0});for(let t=0;t<c.start.length;t+=1){let e=c.start[t];t++;let r=c.end[t]||c.end[0];s.drawLine(e,r),s.drawLine(r,c.start[t+1]||c.start[0])}},S="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var k,P=(function(t,e){!function(r){var o={paper:null},i={documentStyles:[],virtualStyles:{},contexts:[],defaults:{arc:{background:"rgba(0, 0, 0, 0)",strokeStyle:"rgba(0, 0, 0, 0)",lineWidth:null},rect:{background:"rgba(0, 0, 0, 0)",strokeStyle:"rgba(0, 0, 0, 0)",lineWidth:null},polygon:{background:"rgba(0, 0, 0, 0)",strokeStyle:"rgba(0, 0, 0, 0)",lineWidth:null},line:{strokeStyle:"rgba(0, 0, 0, 0)",lineWidth:null},text:{font:"14px Helvetica",strokeStyle:"rgba(0, 0, 0, 0)",color:"#000",lineWidth:null}}};o.warning=function(t,e){console&&console.warn&&console.warn("[origami.js]",t,e)},o.error=function(t){throw new Error("[origami.js]".concat(" "+t))},o.init=function(t){(t=t.canvas?t.canvas:document.querySelector(t))||this.error("Please use a valid selector or canvas context");var e=function(t,e){for(var r=0;r<e.length;r++)if(e[r].element.isEqualNode(t))return e[r];return!1}(t,i.contexts);if(e)return this.paper=e,this;t.getContext||this.error("Please verify if it's a valid canvas element"),t.width=t.clientWidth,t.height=t.clientHeight;var r=t.getContext("2d"),o={element:t,queue:[],index:i.contexts.length,flip:!1,frame:null,ctx:r,width:t.width,height:t.height};return i.contexts.push(o),this.paper=o,this},o.styles=function(){i.virtualStyles.length||function(){for(var t=0;t<document.styleSheets.length;t++){var e=document.styleSheets[t],r=e.cssRules?e.cssRules:e.rules;i.documentStyles.push(r)}}();var t=arguments;if(!t.length)return i.virtualStyles.empty=!0,this;for(var e=0;e<t.length;e++){var r=p(t[e],i.documentStyles[0]||[]);i.virtualStyles[t[e]]=r}return this},o.getPaper=function(){return this.paper},o.canvasCtx=function(){return this.paper.ctx},o.getContexts=function(){return i.contexts},o.cleanContexts=function(){i.contexts=[]},o.createComponent=function(t,e){o[t]=function(t){return e.bind(this,this,t)(),this}},o.fn={},o.draw=function(t){var e=!1,r=this.paper.ctx;"string"==typeof t&&(e=new origami.fn[t](this.paper),this.paper.ctx=e);for(var i=new d(this.paper),a=this.paper.queue,n=0;n<a.length;n++)(!1===a[n].loaded||a[n].failed)&&o.warning("couldn't able to load:",a[n].params),i[a[n].assign](a[n].params);this.paper.queue=[],e&&(e.draw(),this.paper.ctx=r),"function"==typeof t&&t()},o.load=function(t){var e=function(t){if(null==t||"object"!=typeof t)return t;var e=t.constructor();for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}(this);e.paper=this.paper;var r=setInterval(function(){e.paper.queue.filter(function(t){return!1===t.loaded&&!t.failed}).length||(clearInterval(r),t.bind(e,e)())},1)};var a=function(t,e,r){this.paper.queue.push({assign:t,params:e,loaded:r})}.bind(o),n=Object.prototype.hasOwnProperty;function s(t,e){for(var r=e||["x","y","width","height"],o={},i=0;i<t.length;i++)"object"==typeof t[i]?o.style=t[i]:r.length&&(o[r.shift()]=t[i]);return o.style=l(o.style),"string"==typeof o.x&&"string"==typeof o.y&&(o=c(o)),o}function l(t){t||(t={});var e=t.borderSize||null,r=t.borderColor||null,o=t.borderStyle||[];if(t.border){var i=[],a=t.border;i=i.concat(t.border.match(/[0-9]*\.?[0-9]px?/i)),a=a.replace(/[0-9]*\.?[0-9]px?/i,""),i=i.concat(a.match(/solid|dashed|dotted/i)),a=a.replace(/solid|dashed|dotted/i,""),i=i.concat(a.match(/[^\s]+/i)),e||(e=i[0]),r||(r=i[2]),o=i[1]}return e&&(e=e.replace(/[^0-9]/g,"")),"string"==typeof o&&(o="dashed"===o?[12]:"dotted"===o?[3]:[]),t.borderSize=e,t.borderStyle=o,t.borderColor=r,t}function c(t){var e=t.x,r=t.y,i=o.getPaper(),a=i.element.width,n=i.element.height,s=t.r||0,l=t.width||s,c=t.height||l,h={x:["right","center","left"],y:["top","center","bottom"]};return-1!==h.x.indexOf(e)?"right"===e?e=Math.floor(a-l):"center"===e?e=s?Math.floor(a/2):Math.floor(a/2-l/2):"left"===e&&(e=s):e="%"===(e+"").substr(-1)?a*parseInt(e,10)/100:0,-1!==h.y.indexOf(r)?"top"===r?r=s:"center"===r?r=s?Math.floor(n/2):Math.floor(n/2-c/2):"bottom"===r&&(r=Math.floor(n-c)):r="%"===(r+"").substr(-1)?n*parseInt(r,10)/100:0,t.y=r,t.x=e,t}function h(t,e,r){for(var o in e)n.call(e,o)&&("constructor"===o&&t===S||(void 0===e[o]?delete t[o]:r&&void 0!==t[o]||(t[o]=e[o])));return t}function p(t,e){for(var r=0;r<e.length;r++)if(e[r].selectorText&&e[r].selectorText.toLowerCase()===t)return e[r].style}function d(t){this.paper=t}d.prototype.translate=function(t){this.paper.ctx.translate(t.x,t.y)},d.prototype.background=function(t){this.paper.element.style.backgroundColor=t.color},d.prototype.restore=function(){this.paper.ctx.restore()},d.prototype.save=function(){this.paper.ctx.save()},d.prototype.composition=function(t){this.paper.ctx.globalCompositeOperation=t.globalComposite},d.prototype.rotate=function(t){this.paper.ctx.rotate(t.degrees)},d.prototype.scale=function(t){this.paper.ctx.scale(t.width,t.height)},d.prototype.flip=function(t){this.paper.flip="horizontal",t.type&&"string"==typeof t.type&&(this.paper.flip=t.type)},d.prototype.flipEnd=function(){this.paper.flip=!1},d.prototype.clear=function(){this.paper.ctx.clearRect(0,0,this.paper.width,this.paper.height)},d.prototype.arc=function(t){var e=t.args,r=e.style,o=i.defaults.arc;this.paper.ctx.beginPath(),this.paper.ctx.setLineDash(r.borderStyle),this.paper.ctx.arc(e.x,e.y,e.r||o.radius,e.sAngle||0,e.eAngle||2*Math.PI),this.paper.ctx.fillStyle=r.background||r.bg?r.background||r.bg:o.background,this.paper.ctx.fill(),this.paper.ctx.lineWidth=r.borderSize?r.borderSize:o.lineWidth,this.paper.ctx.strokeStyle=r.borderColor?r.borderColor:o.strokeStyle,this.paper.ctx.stroke(),this.paper.ctx.setLineDash([]),this.paper.ctx.closePath()},o.arc=function(){var t=[].slice.call(arguments);return t=s(t,["x","y","r","sAngle","eAngle"]),a("arc",{args:t}),this},d.prototype.image=function(t){var e=t.image,r=t.x,o=t.y,i=t.width,a=t.height;this.paper.ctx.save(),this.paper.flip&&("horizontal"===this.paper.flip&&(this.paper.ctx.scale(-1,1),i*=-1,r*=-1),"vertical"===this.paper.flip&&(this.paper.ctx.scale(1,-1),a*=-1,o*=-1)),this.paper.ctx.beginPath(),this.paper.ctx.drawImage(e,Math.floor(r||0),Math.floor(o||0),i,a),this.paper.ctx.closePath(),this.paper.ctx.restore()},o.image=function(t,e,r,o,n){if(!t)return this;if("string"==typeof t){var s=new Image;s.src=t,t=s}var l={image:t,x:e,y:r,width:o,height:n};if("string"==typeof l.x&&"string"==typeof l.y&&(l=c(l)),t.complete)return l.width=o||t.naturalWidth,l.height=n||t.naturalHeight,a("image",l),this;a("image",l,!1);var h=this.paper.queue.length-1,p=i.contexts[this.paper.index].queue[h];return t.addEventListener("load",function(){if(!p)return!1;p.params.width=l.width||t.naturalWidth,p.params.height=l.height||t.naturalHeight,p.loaded=!0}),t.addEventListener("error",function(){if(!p)return!1;p.failed=!0}),this},d.prototype.line=function(t){var e=i.defaults.line,r=t.style,o=t.pointA,a=t.pointB;this.paper.ctx.beginPath(),this.paper.ctx.setLineDash(r.borderStyle),this.paper.ctx.moveTo(o.x||0,o.y||0),this.paper.ctx.lineTo(a.x||0,a.y||0),this.paper.ctx.lineWidth=r.borderSize?r.borderSize:e.lineWidth,this.paper.ctx.strokeStyle=r.borderColor?r.borderColor:e.strokeStyle,this.paper.ctx.stroke(),this.paper.ctx.setLineDash([]),this.paper.ctx.closePath()},o.line=function(t,e,r){return r=l(r),a("line",{pointA:t,pointB:e,style:r}),this},d.prototype.polygon=function(t){var e=t.args,r=t.style,o=i.defaults.polygon;this.paper.ctx.beginPath(),this.paper.ctx.setLineDash(r.borderStyle),this.paper.ctx.fillStyle=r.background?r.background:o.background,this.paper.ctx.lineWidth=r.borderSize?r.borderSize:o.lineWidth,this.paper.ctx.strokeStyle=r.borderColor?r.borderColor:o.strokeStyle;for(var a=0;a<e.length;a++)e[a].x&&(a?this.paper.ctx.lineTo(e[a].x,e[a].y):this.paper.ctx.moveTo(e[a].x,e[a].y));this.paper.ctx.fill(),this.paper.ctx.stroke(),this.paper.ctx.setLineDash([]),this.paper.ctx.closePath()},o.polygon=function(){var t=[].slice.call(arguments),e=s(t);return a("polygon",{style:e.style,args:t}),this},d.prototype.rect=function(t){var e=i.defaults.rect,r=t.style,o=t.args;this.paper.ctx.beginPath(),this.paper.ctx.setLineDash(r.borderStyle),this.paper.ctx.fillStyle=r.background?r.background:e.background,this.paper.ctx.fillRect(o.x,o.y,o.width,o.height||o.width),this.paper.ctx.lineWidth=r.borderSize?r.borderSize:e.lineWidth,this.paper.ctx.strokeStyle=r.borderColor?r.borderColor:e.strokeStyle,this.paper.ctx.strokeRect(o.x,o.y,o.width,o.height||o.width),this.paper.ctx.setLineDash([]),this.paper.ctx.closePath()},o.rect=function(){var t=[].slice.call(arguments);return t=s(t),a("rect",{style:t.style,args:t}),this},o.border=function(){var t=[].slice.call(arguments);return t=s(t),a("rect",{style:t.style,args:{x:0,y:0,width:this.paper.width,height:this.paper.height}}),this},d.prototype.CSSShape=function(t){var e=this;if(!(t=i.virtualStyles[t]))return e;var o='<svg xmlns="http://www.w3.org/2000/svg" width="'+e.paper.width+'px" height="'+e.paper.height+'px"><foreignObject width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml"><div style="'+t.cssText+'"></div></div></foreignObject></svg>',a=r.URL||r.webkitURL||r,n=new Image,s=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),l=a.createObjectURL(s);return n.src=l,n.addEventListener("load",function(){e.paper.ctx.beginPath(),e.paper.ctx.drawImage(n,0,0),a.revokeObjectURL(l),e.paper.ctx.closePath()}),e},o.shape=function(t){return a("CSSShape",t),this},d.prototype.sprite=function(t){var e=t.properties,o=t.width/e.frames;(function t(e){var o=this;if(e.posX===e.widthTotal){if(!1===e.loop)return void r.cancelAnimationFrame(e.animation);e.posX=0}o.paper.ctx.clearRect(e.dx,e.dy,e.width,e.height),o.paper.ctx.beginPath(),o.paper.ctx.drawImage(e.image,e.posX,e.posY,e.width,e.height,e.dx,e.dy,e.width,e.height),o.paper.ctx.closePath(),e.posX=e.posX+e.width,setTimeout(function(){e.animation=r.requestAnimationFrame(t.bind(o,e))},e.speed)}).call(this,{image:t.image,posX:0,posY:0,frame:e.frames,loop:e.loop,width:o,widthTotal:t.width,height:t.height,dx:t.x,dy:t.y,speed:e.speed,animation:null})},o.sprite=function(t,e,r){if(!r||!r.src)return this;var o=new Image;r.frames,r.loop,r.speed;o.src=r.src;var n={x:t,y:e,image:o,properties:r,width:0,height:0};if(o.complete)return n.width=o.naturalWidth,n.height=o.naturalHeight,a("sprite",n),this;a("sprite",n,!1);var s=this.paper.queue.length-1,l=i.contexts[this.paper.index].queue[s];return o.addEventListener("load",function(){if(!l)return!1;l.params.width=o.naturalWidth,l.params.height=o.naturalHeight,l.loaded=!0}),o.addEventListener("error",function(){if(!l)return!1;l.failed=!0}),this},d.prototype.text=function(t){var e=i.defaults.text,r=t.text,o=t.x,a=t.y,n=t.style;this.paper.ctx.beginPath(),this.paper.ctx.setLineDash(n.borderStyle),this.paper.ctx.lineWidth=n.borderSize?n.borderSize:e.lineWidth,this.paper.ctx.strokeStyle=n.borderColor?n.borderColor:e.strokeStyle,this.paper.ctx.font=n.font||e.font,this.paper.ctx.fillStyle=n.color||e.color,this.paper.ctx.textAlign=n.align||e.align,this.paper.ctx.fillText(r,o,a),this.paper.ctx.strokeText(r,o,a),this.paper.ctx.fill(),this.paper.ctx.stroke(),this.paper.ctx.setLineDash([]),this.paper.ctx.closePath()},o.text=function(t,e,r,o){var i={text:t,x:e,y:r,style:o=l(o)};return"string"==typeof i.x&&"string"==typeof i.y&&(i=c(i)),a("text",i),this},d.prototype.chartLine=function(t){var e=this.paper.ctx,r=this.paper.width,o=this.paper.height,i=l({border:t.line||"1px solid #000"}),a=40,n=40,s=[],c={vertical:!0,horizontal:!0};t.gridLines&&(!1===t.gridLines.vertical&&(c.vertical=!1),!1===t.gridLines.horizontal&&(c.horizontal=!1));for(var h=0;h<t.labels.length;h++)s.push({X:t.labels[h],Y:t.data[h]});function p(){for(var t=0,e=0;e<s.length;e++)s[e].Y>t&&(t=s[e].Y);return t+=10-t%10}function d(t){return(r-a)/s.length*t+a}function u(t){return o-(o-n)/p()*t-n}for(e.lineWidth=.8,e.strokeStyle="#999",e.font="normal 12px Helvetica",e.fillStyle="#5e5e5e",e.textAlign="center",e.beginPath(),e.moveTo(a,n/2),e.lineTo(a,o-n),e.lineTo(r-a/2,o-n),e.stroke(),e.textAlign="right",e.textBaseline="middle",h=0;h<p();h+=10)c.horizontal&&(e.beginPath(),e.lineWidth=.8,e.strokeStyle="#e7e7e7",e.moveTo(a-5,u(h)),e.lineTo(r-a/2,u(h)),e.stroke()),e.fillText(h,a-10,u(h));for(e.textAlign="left",h=0;h<s.length;h++)c.vertical&&(e.beginPath(),e.lineWidth=.8,e.strokeStyle="#e7e7e7",e.moveTo(d(h),o-n+10),e.lineTo(d(h),n/2),e.stroke()),e.fillText(s[h].X,d(h),o-n+20);for(e.beginPath(),e.lineWidth=i.borderSize,e.setLineDash(i.borderStyle),e.strokeStyle=i.borderColor,e.moveTo(d(0),u(s[0].Y)),h=1;h<s.length;h++)e.lineTo(d(h),u(s[h].Y));if(e.stroke(),e.setLineDash([]),t.points)for(e.fillStyle=t.pointsColor?t.pointsColor:"rgb(75,75,75)",h=0;h<s.length;h++)e.beginPath(),e.arc(d(h),u(s[h].Y),3,0,2*Math.PI,!0),e.fill()},o.chartLine=function(t){return a("chartLine",t),this},o.background=function(t){return a("background",{color:t}),this},o.restore=function(){return a("restore"),this},o.save=function(){return a("save"),this},o.composition=function(t){return a("composition",{globalComposite:t}),this},o.translate=function(t,e){return null==t&&(t="reset"),"string"==typeof t&&("center"===t&&(t=context.width/2,e=context.height/2),"reset"===t&&(t=-context.width/2,e=-context.height/2)),a("translate",{x:t,y:e}),this},o.rotate=function(t){return void 0===t&&(t="slow"),"string"==typeof t&&("slow"===t?t=2*Math.PI/60*(new Date).getSeconds()+2*Math.PI/6e4*(new Date).getMilliseconds():"normal"===t?t=2*Math.PI/30*(new Date).getSeconds()+2*Math.PI/3e4*(new Date).getMilliseconds():"fast"===t&&(t=2*Math.PI/6*(new Date).getSeconds()+2*Math.PI/6e3*(new Date).getMilliseconds())),a("rotate",{degrees:t}),this},o.stopRender=function(){r.cancelAnimationFrame(this.paper.frame),this.paper.frame=!1},o.play=function(){return this.paper.frame=1,this},o.startRender=function(t){var e=this;!1!==e.paper.frame&&e.draw(function(){e.paper.frame=r.requestAnimationFrame(t.bind(this))})},o.scale=function(t,e){return a("scale",{width:t,height:e}),this},o.flip=function(t){return a("flip",{type:t}),this},o.flipEnd=function(){return a("flipEnd"),this},o.clear=function(){return a("clear"),this},o.on=function(t,e){return this.paper.element.addEventListener(t,e),this};var u=h(o.init.bind(this),o);t&&t.exports?t.exports=u:e?e.origami=u:"object"==typeof r&&(r.origami=h(o.init.bind(o),o))}(function(){return this}())}(k={exports:{}},k.exports),k.exports),M=(P.origami,t=>{let{data:e,options:r,ctx:o,h:i,w:a,Helper:n,canvasId:s}=t;new n(o);P.bind({})(o).rect(10,10,40,40).draw()});function _(t){this.ctx=t,this.mainColor="black"}function C(){this.current_stream={},this.sources={},this.onFileLoad=null,this.activeElements={},this.activated=!1,window.AudioContext=window.AudioContext||window.webkitAudioContext}return _.prototype={__toRadians__:t=>t*Math.PI/180,__rotatePoint__([t,e],[r,o],i){let a=this.__toRadians__(i);return[Math.cos(a)*(t-r)-Math.sin(a)*(e-o)+r,Math.sin(a)*(t-r)+Math.cos(a)*(e-o)+o]},mutateData(t,e,r=null){if("mirror"===e){let e=[];for(let r=0;r<t.length;r+=2)e.push(t[r]);return e=[...e,...e.reverse()]}if("shrink"===e){r<1&&(r=t.length*r);let e=[],o=Math.floor(t.length/r);for(let i=1;i<=r;i++){let r=t.slice(i*o,i*o+o),a=r[Math.floor(r.length/2)];e.push(a)}return e}if("split"===e){let e=Math.floor(t.length/r),o=[],i=[],a=0;for(let n=0;n<=e*r;n++)a===e&&(o.push(i),i=[],a=0),i.push(t[n]),a++;return o}if("scale"===e){let e=r/255;return r<=3&&r>=0&&(e=r),t.map(t=>t*e)}if("organize"===e){let e={};return e.base=t.slice(60,120),e.vocals=t.slice(120,255),e.mids=t.slice(255,2e3),e}if("reverb"===e){let e=[];return t.forEach((r,o)=>{e.push(r-(t[o+1]||0))}),e}if("amp"===e){let e=[];return t.forEach(t=>{e.push(t*(r+1))}),e}if("min"===e){let e=[];return t.forEach(t=>{t<r&&(t=r),e.push(t)}),e}},getPoints(t,e,[r,o],i,a,n={}){let{offset:s=0,rotate:l=0,customOrigin:c=[]}=n,h={start:[],end:[]};if("circle"===t){let t=360/i,n=this.__toRadians__(t),c=e/2;for(let t=1;t<=i;t++){let e=n*t,i=a[t-1],p=a[t-1]*(s/100),d=r+(c-p)*Math.cos(e),u=o+(c-p)*Math.sin(e),f=this.__rotatePoint__([d,u],[r,o],l);h.start.push(f),d=r+(c-p+i)*Math.cos(e),u=o+(c-p+i)*Math.sin(e);let g=this.__rotatePoint__([d,u],[r,o],l);h.end.push(g)}return h}if("line"===t){let t=e/i;r=c[0]||r,o=c[1]||o;for(let e=0;e<=i;e++){let i=l,n=a[e]*(s/100),c=this.__rotatePoint__([r+e*t,o-n],[r,o],i);h.start.push(c);let p=this.__rotatePoint__([r+e*t,o+a[e]-n],[r,o],i);h.end.push(p)}return h}},drawCircle([t,e],r,o={}){let{color:i,lineColor:a=this.ctx.strokeStyle}=o;this.ctx.beginPath(),this.ctx.arc(t,e,r/2,0,2*Math.PI),this.ctx.strokeStyle=a,this.ctx.stroke(),this.ctx.fillStyle=i,i&&this.ctx.fill()},drawOval([t,e],r,o,i={}){let{rotation:a=0,color:n,lineColor:s=this.ctx.strokeStyle}=i;a&&(a=this.__toRadians__(a)),this.ctx.beginPath(),this.ctx.ellipse(t,e,o,r,a,0,2*Math.PI),this.ctx.strokeStyle=s,this.ctx.stroke(),this.ctx.fillStyle=n,n&&this.ctx.fill()},drawSquare([t,e],r,o={}){this.drawRectangle([t,e],r,r,o)},drawRectangle([t,e],r,o,i={}){let{color:a,lineColor:n=this.ctx.strokeStyle,radius:s=0,rotate:l=0}=i;this.ctx.beginPath(),this.ctx.moveTo(t+s,e);let c=this.__rotatePoint__([t+o,e],[t,e],l),h=this.__rotatePoint__([t+o,e+r],[t,e],l);this.ctx.arcTo(c[0],c[1],h[0],h[1],s);let p=this.__rotatePoint__([t+o,e+r],[t,e],l),d=this.__rotatePoint__([t,e+r],[t,e],l);this.ctx.arcTo(p[0],p[1],d[0],d[1],s);let u=this.__rotatePoint__([t,e+r],[t,e],l),f=this.__rotatePoint__([t,e],[t,e],l);this.ctx.arcTo(u[0],u[1],f[0],f[1],s);let g=this.__rotatePoint__([t,e],[t,e],l),x=this.__rotatePoint__([t+o,e],[t,e],l);this.ctx.arcTo(g[0],g[1],x[0],x[1],s),this.ctx.closePath(),this.ctx.strokeStyle=n,this.ctx.stroke(),this.ctx.fillStyle=a,a&&this.ctx.fill()},drawLine([t,e],[r,o],i={}){let{lineColor:a=this.ctx.strokeStyle}=i;this.ctx.beginPath(),this.ctx.moveTo(t,e),this.ctx.lineTo(r,o),this.ctx.strokeStyle=a,this.ctx.stroke()},drawPolygon(t,e={}){let{color:r,lineColor:o=this.ctx.strokeStyle,radius:i=0,close:a=!1}=e;function n(t,e,r,o,i,a){let n=Math.sqrt((r-t)**2+(o-e)**2),s=a?i/n:(n-i)/n;return[t+s*(r-t),e+s*(o-e)]}i>0&&(t=function(t,e){let r=t.length,o=new Array(r);for(let i=0;i<r;i++){let a=i-1,s=i+1;a<0&&(a=r-1),s==r&&(s=0);let l=t[a],c=t[i],h=t[s],p=n(l[0],l[1],c[0],c[1],e,!1),d=n(c[0],c[1],h[0],h[1],e,!0);o[i]=[p[0],p[1],c[0],c[1],d[0],d[1]]}return o}(t,i));let s,l,c=t.length;for(s=0;s<c;s++)l=t[s],0==s?(this.ctx.beginPath(),this.ctx.moveTo(l[0],l[1])):this.ctx.lineTo(l[0],l[1]),i>0&&this.ctx.quadraticCurveTo(l[2],l[3],l[4],l[5]);a&&this.ctx.closePath(),this.ctx.strokeStyle=o,this.ctx.stroke(),this.ctx.fillStyle=r,r&&this.ctx.fill()}},C.prototype={fromElement:function(t,e,r){const o=[r.globalAccessKey||"$wave"],i=r.getGlobal||function(t,e){return(t=>{window[o]=window[o]||{},window[o][t]=window[o][t]||{}})(t),window[o][t][e]},a=r.setGlobal||function(t,e,r){let a=i(t);return a||(window[o][t][e]=window[o][t][e]||r,a=window[o][t][e]),a},n=this;let s=document.getElementById(t);if(!s)return;function l(){this.activated=!0,this.activeCanvas=this.activeCanvas||{},this.activeCanvas[e]=JSON.stringify(r),this.activeElements[t]=this.activeElements[t]||{},this.activeElements[t].count?this.activeElements[t].count+=1:this.activeElements[t].count=1;const o=this.activeElements[t].count,n=a(s.id,"audioCtx",new AudioContext),l=a(s.id,"analyser",n.createAnalyser());let c=i(s.id,"source");c?c.mediaElement!==s&&(c=n.createMediaElementSource(s)):c=n.createMediaElementSource(s),a(s.id,"source",c);const h=n.createOscillator();h.frequency.value=1,h.connect(n.destination),h.start(0),h.stop(0),c.connect(l),c.connect(n.destination),l.fftsize=32768;const p=l.frequencyBinCount,d=new Uint8Array(p);let u=1;function f(){JSON.stringify(r)===this.activeCanvas[e]&&document.getElementById(t)&&document.getElementById(e)&&(requestAnimationFrame(f),u++,o<this.activeElements[t].count||(l.getByteFrequencyData(d),this.activeElements[t].data=d),this.visualize(this.activeElements[t].data,e,r,u))}(f=f.bind(this))()}s.crossOrigin="anonymous";const c=()=>{["touchstart","touchmove","touchend","mouseup","click","play"].forEach(t=>{s.removeEventListener(t,c,{once:!0})}),l.call(n)};this.activated||r.skipUserEventsWatcher?l.call(n):(document.body.addEventListener("touchstart",c,{once:!0}),document.body.addEventListener("touchmove",c,{once:!0}),document.body.addEventListener("touchend",c,{once:!0}),document.body.addEventListener("mouseup",c,{once:!0}),document.body.addEventListener("click",c,{once:!0}),s.addEventListener("play",c,{once:!0}))},fromFile:function(t,e={}){e.stroke||(e.stroke=10);let r=new Audio;r.src=t;let o=new AudioContext,i=o.createAnalyser();o.createMediaElementSource(r).connect(i),i.fftSize=64;let a,n,s=i.frequencyBinCount,l=new Uint8Array(s),c=0,h=this;r.addEventListener("loadedmetadata",async function(){for(;r.duration===1/0;)await new Promise(t=>setTimeout(t,1e3)),r.currentTime=1e7*Math.random();r.currentTime=0,r.play()}),r.onplay=function(){let t=r.duration;r.playbackRate=16;let e=(t/=r.playbackRate)/.02*(i.fftSize/2);e=(t=>{for(let e=1;e<=40;e++){let r=2**e;if(t<=r)return r}})(e),a=new Uint8Array(e),n=setInterval(function(){i.getByteFrequencyData(l);for(let t in l)t=l[t],a[c]=t,c++},20)},r.onended=function(){if(r.currentTime===r.duration&&void 0!==a){clearInterval(n);let t=document.createElement("canvas");t.height=window.innerHeight,t.width=window.innerWidth,h.visualize(a,t,e);let r=t.toDataURL("image/jpg");h.onFileLoad(r),t.remove()}}},...t,visualize:function(t,S,k={},P){(k={...k}).stroke||(k.stroke=1),k.colors||(k.colors=["#d92027","#ff9234","#ffcd3c","#35d0ba"]);let _=document.getElementById(S);if(!_)return;let C=_.getContext("2d"),D=_.height,T=_.width;C.strokeStyle=k.colors[0],C.lineWidth=k.stroke;let E={bars:i,"bars blocks":c,"big bars":x,cubes:g,dualbars:a,"dualbars blocks":h,fireworks:m,flower:s,"flower blocks":l,orbs:n,ring:o,rings:u,"round layers":M,"round wave":d,shine:r,"shine rings":f,shockwave:y,star:p,static:w,stitches:b,wave:e,web:v},L={bars:1,"bars blocks":1,"big bars":1,cubes:1,dualbars:1,"dualbars blocks":1,fireworks:1,flower:1,"flower blocks":1,ring:1,rings:1,"round layers":1,"round wave":1,orbs:1,shine:1,"shine rings":1,shockwave:1,star:1,static:1,stitches:1,wave:1,web:1};const I={data:t,options:k,ctx:C,h:D,w:T,Helper:this.Helper,canvasId:S};"string"==typeof k.type&&(k.type=[k.type]),k.type.forEach(t=>{P%L[t]==0&&(C.clearRect(0,0,T,D),C.beginPath(),E[t](I))})},Helper:_},C}();